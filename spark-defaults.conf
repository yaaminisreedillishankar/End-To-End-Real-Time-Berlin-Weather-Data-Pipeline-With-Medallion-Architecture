# Auto-generated for YARN
spark.master                     yarn
spark.submit.deployMode          client
# Resources (tune)
spark.driver.memory              2g
spark.executor.memory            2g
spark.executor.cores             2
# History Server event logs
spark.eventLog.enabled           true
spark.eventLog.dir               hdfs:///spark-logs
spark.history.fs.logDirectory    hdfs:///spark-logs
# Pin Python on driver & executors
spark.yarn.appMasterEnv.PYSPARK_PYTHON    /usr/bin/python3.12
spark.executorEnv.PYSPARK_PYTHON         /usr/bin/python3.12
# Route around flaky DNs (optional safety)
spark.hadoop.dfs.client.block.write.replace-datanode-on-failure.enable  true
spark.hadoop.dfs.client.block.write.replace-datanode-on-failure.policy  ALWAYS
spark.hadoop.dfs.client.writer.exclude.nodes.cache.expiry.interval.millis 60000
